# 智能指针

在现代 C++中，标准库包含了智能指针，该指针用于确保程序不存在「内存和资源泄露」而且是异常安全的。

RAII：利用栈和析构函数来控制堆上资源的分配，在 C++11 之前，需要手动在构造函数和析构函数的代码中获得和释放资源，在 C++11 之后，可以使用标准库中的智能指针。

C++11之前：

```cpp
class widget
{
private:
    int* data;
public:
    widget(const int size) { data = new int[size]; } // acquire
    ~widget() { delete[] data; } // release
    void do_something() {}
};

void functionUsingWidget() {
    widget w(1000000);  // lifetime automatically tied to enclosing scope
                        // constructs w, including the w.data member
    w.do_something();

} // automatic destruction and deallocation for w and w.data
```

使用智能指针：

```cpp
#include <memory>
class widget
{
private:
    std::unique_ptr<int[]> data;
public:
    widget(const int size) { data = std::make_unique<int[]>(size); }
    void do_something() {}
};

void functionUsingWidget() {
    widget w(1000000);  // lifetime automatically tied to enclosing scope
                        // constructs w, including the w.data gadget member
    // ...
    w.do_something();
    // ...
} // automatic destruction and deallocation for w and w.data
```

可以不在`widget`类中显式析构函数。

RAII 的主要原则是为将「任何堆分配资源（例如，动态分配内存或系统对象句柄）的所有权」提供给 「析构函数包含用于 删除或释放资源的代码」 以及「任何相关清理代码的堆栈分配对象」。

## 智能指针的使用

