# 输入一个URL后到用户完整看到网页发生了什么？

首先对于这种非常宏大的开放性问题，从以下两个角度考虑

1.   一致性（所提出的概念是一个层次的）

     例如讲到CPU中断就绕不开汇编。

2.   完备性

一般回答粒度要控制在比较粗的程度。

## 角度1:以浏览器的角度去看待

1.   HTTP请求

     http或https协议

     从URL变成http response和request

     http的缓存机制、状态码、续传处理

2.   DOM树的构建

     从response 的body里面解析出来HTML代码，以状态机和栈来做html语言的语法分析得到DOM树

3.   CSS属性的计算

     从BOM树中取出CSS代码，CSS语法分析，选择器优先级

4.   排版

     

5.   渲染

     渲染元素绘制到现实设备

## 角度2: 从设备角度看待

可以分为三类设备和五个阶段

三类设备是：

1.   客户端
2.   网络
3.   服务器端

五个阶段是：

1.   在客户端（浏览器）构造和发起请求

2.   网络传输阶段

     OSI七层结构

3.   服务端处理阶段

     负载均衡、连接保持、网关、计算型集群、存储型集群、分库分表、消息队列

4.   网络传回，大致与第二个阶段相同，方向不一致

5.   客户端（浏览器）处理数据，完成渲染

## 角度3:从性能角度看待

1.   开始传输HTML之前

     网络相关：DNS请求和传输回应的HTTP头，此时用户看到的是白屏

2.   HTML head传输

3.   HTML body传输

4.   DOMContentLoaded之后

## 个人想法

回答思路很多，我的知识栈就从第二个角度回答。