# 单例模式

## 简介

单例模式指在整个系统生命周期里，保证一个类只能产生一个实例，确保该类的**唯一性**。

单例模式可以分为「懒汉式」和「饿汉式」，两者之间的区别在于创建实例的时间不同：

-   **懒汉式**：指系统运行中，实例并不存在，只有当需要使用该实例时，才回去创建并使用实例。（需要考虑线程安全）
-   **饿汉式**：指系统一运行，就初始化创建实例，当需要时，直接调用即可。（本身就线程安全）

>   所谓「线程安全」，就是在拥有共享数据的「多条线程并行执行」的程序中，线程安全的代码会通过「同步机制」保证每个线程都可以正常且正确的执行，不会出现数据污染等意外情况。



**单例类的特点：**

-   构造函数和析构函数都是`private`类型，禁止外部构造和析构
-   拷贝构造和赋值构造函数为`private`类型，禁止外部拷贝和赋值，确保实例的唯一性
-   类里有个获取实例的「静态函数」，可以全局访问



## 01 线程不安全的懒汉式单例

<img src="https://raw.githubusercontent.com/Missyesterday/picgo/main/picgo/image-20230315141825456.png" alt="image-20230315141825456" style="zoom:50%;" />

可见这是线程不安全的。



## 02 线程安全的加锁懒汉式单例

<img src="https://raw.githubusercontent.com/Missyesterday/picgo/main/picgo/image-20230315151405849.png" alt="image-20230315151405849" style="zoom:50%;" />

可见这是线程安全的。